---
title: "Звіт до лабораторної роботи №3"
author: "Варакута Олександр КІ-24-1"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(moments)
library(kableExtra)
library(beeswarm)
library(magrittr)  # підключаємо pipe %>%
```

# Постановка завдання

**Тема**: Основи вибіркового методу\
**Мета**: Засвоїти статистичне оцінювання характеристик логнормального розподілу за допомогою R та порівняти теоретичні і вибіркові характеристики.\
**Завдання**:\
Згенерувати вибірки обсягів $n=100$ та $n=10000$ для $X \sim \text{LogNormal}(\mu=0, \sigma=0.25)$.\
Розрахувати:\
- Теоретичні характеристики (середнє, медіана, дисперсія, СКВ, моменти 3-го і 4-го порядків, асиметрія, ексцес).\
- Вибіркові оцінки цих характеристик для обох вибірок.\
- Побудувати графіки (гістограми, емпіричні та теоретичні ФР, boxplot-и).\
- Порівняти результати у зведеній таблиці.

------------------------------------------------------------------------

# Теоретичні характеристики логнормального розподілу

```{r}
mu <- 0
sigma <- 0.25

# Теоретичні характеристики
theoretical_mean <- exp(mu + sigma^2 / 2)
theoretical_median <- exp(mu)
theoretical_var <- (exp(sigma^2) - 1) * exp(2*mu + sigma^2)
theoretical_sd <- sqrt(theoretical_var)
theoretical_cv <- sqrt(exp(sigma^2) - 1)
theoretical_skew <- (exp(sigma^2) + 2) * sqrt(exp(sigma^2) - 1)
theoretical_kurt <- exp(4*sigma^2) + 2*exp(3*sigma^2) + 3*exp(2*sigma^2) - 6

theoretical_mu3 <- (exp(sigma^2)-1)*(exp(3*sigma^2)+3*exp(2*sigma^2)+1)*exp(3*mu+1.5*sigma^2)
theoretical_mu4 <- exp(4*mu+8*sigma^2) - 4*exp(3*mu+4.5*sigma^2)*theoretical_mean +
  6*exp(2*mu+2*sigma^2)*theoretical_mean^2 - 3*theoretical_mean^4
```

<button onclick="var x=document.getElementById(&#39;formula-block&#39;); if (x.style.display===&#39;none&#39;){x.style.display=&#39;block&#39;;}else{x.style.display=&#39;none&#39;;}">

Показати/Приховати формули

</button>

::: {#formula-block style="display: none;"}
$$
f(x)=\frac{1}{x\sigma\sqrt{2\pi}}e^{-\frac{(\log(x)-\mu)^2}{2\sigma^2}}, \quad x>0 \\
E[X]=e^{\mu+\frac{\sigma^2}{2}} \\
Var[X]=(e^{\sigma^2}-1)e^{2\mu+\sigma^2} \\
CV=\sqrt{e^{\sigma^2}-1}
$$
:::

------------------------------------------------------------------------

# Генерація вибірок

```{r}
set.seed(123)
n1 <- 100
n2 <- 10000
X1 <- rlnorm(n1, meanlog=mu, sdlog=sigma)
X2 <- rlnorm(n2, meanlog=mu, sdlog=sigma)
```

------------------------------------------------------------------------

# Розрахунок вибіркових характеристик

```{r}
calc_stats <- function(x) {
  m <- mean(x)
  v <- var(x)
  v_adj <- v * length(x) / (length(x)-1)
  sd <- sqrt(v)
  sd_adj <- sqrt(v_adj)
  mu3 <- mean((x - m)^3)
  mu4 <- mean((x - m)^4)
  skew <- skewness(x)
  kurt <- kurtosis(x)
  c(Середнє = m, Медіана=median(x), Дисперсія=v, Виправлена_дисперсія=v_adj,
    СКВ=sd, Виправлене_СКВ=sd_adj, Центральний_момент3=mu3,
    Центральний_момент4=mu4, Асиметрія=skew, Ексцес=kurt)
}

emp1 <- calc_stats(X1)
emp2 <- calc_stats(X2)
```
------------------------------------------------------------------------

# Гістограми та щільності

```{r}
par(mfrow=c(1,2))
hist(X1, probability=TRUE, col="lightblue", main="Гістограма n=100")
curve(dlnorm(x, meanlog=mu, sdlog=sigma), add=TRUE, col="red", lwd=2)
hist(X2, probability=TRUE, col="lightgreen", main="Гістограма n=10000")
curve(dlnorm(x, meanlog=mu, sdlog=sigma), add=TRUE, col="red", lwd=2)
```

![](images/clipboard-435283642.png)

------------------------------------------------------------------------

# Емпіричні та теоретичні ФР

```{r message=TRUE, warning=TRUE, paged.print=TRUE}
plot(ecdf(X1), main="Емпірична ФР n=100", col="blue")
curve(plnorm(x, meanlog=mu, sdlog=sigma), add=TRUE, col="red", lty=2)

plot(ecdf(X2), main="Емпірична ФР n=10000", col="blue")
curve(plnorm(x, meanlog=mu, sdlog=sigma), add=TRUE, col="red", lty=2)
```

![](images/clipboard-413939423.png)

![](images/clipboard-3939921041.png)

------------------------------------------------------------------------

# Boxplot

```{r}
boxplot(X1, main="Boxplot n=100", col="orange", horizontal=TRUE)
beeswarm(X1, add=TRUE, col=2, horizontal=TRUE)
```

![](images/clipboard-3939063958.png)

```{r}
boxplot(X2, main="Boxplot n=10000", col="lightgreen", horizontal=TRUE)
beeswarm(X2, add=TRUE, col=3, horizontal=TRUE)
```

![](images/clipboard-871121416.png)

# Зведена таблиця

```{r}
table_data <- data.frame(
  "Назва числової характеристики" = c("Середнє", "Медіана", "Дисперсія", "Виправлена дисперсія", 
                                      "СКВ", "Виправлене СКВ", "Центральний момент 3-го порядку",
                                      "Центральний момент 4-го порядку", "Асиметрія", "Ексцес"),
  "Теоретичне значення" = round(c(theoretical_mean, theoretical_median, theoretical_var, theoretical_var,
                                   theoretical_sd, theoretical_sd, theoretical_mu3, theoretical_mu4,
                                   theoretical_skew, theoretical_kurt), 4),
  "Вибіркове значення, n=100" = round(emp1, 4),
  "Вибіркове значення, n=10000" = round(emp2, 4)
)

kable(table_data, caption = "Порівняльна таблиця теоретичних та вибіркових характеристик") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

------------------------------------------------------------------------

# Висновки

-   Теоретичні та вибіркові оцінки добре узгоджуються, особливо при $n=10000$.\
-   Логнормальний розподіл має асиметрію та ексцес, що підтверджується результатами.

# Відповіді на контрольні питання

1️⃣ **Що таке вибірка?**\
Вибірка — це підмножина елементів генеральної сукупності, яку беруть для вивчення чи дослідження. Вона повинна репрезентувати основні властивості всієї сукупності.

2️⃣ **Як можна оцінити вибіркове математичне сподівання?**\
Вибіркове математичне сподівання (середнє арифметичне) обчислюється за формулою:\
$$
\bar{X} = \frac{1}{n} \sum_{i=1}^{n} x_i
$$\
де $x_i$ — окремі значення вибірки, $n$ — її обсяг.

3️⃣ **Які існують міри розсіювання?**\
Міри розсіювання показують, наскільки розкидані значення вибірки відносно її середнього. Основні міри: - **Дисперсія**: середній квадрат відхилень від середнього.\
- **Середньоквадратичне відхилення (СКВ)**: корінь із дисперсії.\
- **Міжквартильний розмах**: різниця між третім та першим квартилями.\
- **Коефіцієнт варіації (CV)**: відношення СКВ до середнього значення.

4️⃣ **Які міри форми розподілу вам відомі? Що вони характеризують? Як їх оцінити?**\
Міри форми розподілу описують «форму» розподілу відносно нормального: - **Асиметрія (скошеність)**: показує «зміщення» розподілу вліво або вправо.\
- **Ексцес (гостроверхість)**: показує «гостроту» або «плоскість» розподілу порівняно з нормальним.

# Список джерел

-   Документація R (help(rlnorm))
-   Теоретичні основи логнормального розподілу
-   Методичні вказівки лабораторної роботи
-   help(rlnorm) — офіційна довідка по логнормальному розподілу (dlnorm(), plnorm(), qlnorm(), rlnorm()). \`\`\`
